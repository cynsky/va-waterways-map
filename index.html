<!DOCTYPE html>
<html style="height:100%;">
  <head>
    <title>Map Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="//js.arcgis.com/3.10/js/esri/css/esri.css">
    <style>
      body { font-family: sans-serif; }
      html, body { height: 100%; width: 100%; margin: 0; padding: 0; }
      #menu { position: absolute; top: 0; left: 0; height: 30px; width: 100%; background-color: white;
        -moz-box-siding: border-box; -webkit-box-sizing: border-box; box-sizing: border-box;
        padding: 5px; border-bottom: 1px solid #999;
       }
      #map { position: absolute; top: 30px; bottom: 0; width: 100%; }
    </style>

  </head>
  <body>
    <nav id="menu">
      <strong>Waterways</strong>&nbsp;&nbsp;&nbsp;
      <input type="checkbox" data-layer="bath"> Show Bathymetry (takes a little while the first time)
      <input type="checkbox" data-layer="est"> Show Estuaries
      <input type="checkbox" data-layer="ramp"> Show Boat Ramps
    </nav>
    <div id="map"></div>

    <script src="//js.arcgis.com/3.10compact"></script>
    <script>
      require(["esri/map", "esri/geometry/Point", "esri/layers/ArcGISDynamicMapServiceLayer",
                "esri/layers/KMLLayer", "dojo/domReady!"],
        function(Map, Point, ArcGISDynamicMapServiceLayer, KMLLayer) {
          window.map = new Map("map",{
            basemap:"national-geographic",
            center:[-75.97086160156249,37.89287113281247],
            zoom:12,
            autoResize:true
          });
          window.bathLayer = new ArcGISDynamicMapServiceLayer(
            "http://egisws02.nos.noaa.gov/ArcGIS/rest/services/Estuarine_Bathymetry/NOAA_Estuarine_Bathymetry/MapServer",
            //"http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",
            { visible: false });
          window.estLayer = new ArcGISDynamicMapServiceLayer(
            "http://www.deq.virginia.gov/arcgis/rest/services/public/2012_adb_fishconsump/MapServer",
            { visible: false });
          window.estLayer.setVisibleLayers([4]); // estuarine only
          window.rampLayer = new KMLLayer(
            "http://www.dgif.virginia.gov/gis/kmz/DGIF_Boating_Access_Sites.kmz",
            { visible: false });
          map.addLayers([ bathLayer, estLayer, rampLayer ]);

          if ('geolocation' in navigator) {
            navigator.geolocation.getCurrentPosition(function(pos) {
              var lat = pos.coords.latitude;
              var lon = pos.coords.longitude;
              window.map.centerAt(new Point(lon,lat));
            });
          }

          $('input[type=checkbox][data-layer]').click(function() {
            var layer = window[$(this).attr('data-layer') + 'Layer'];
            if (this.checked) { layer.show(); } else { layer.hide(); }
          });
      });
    </script>
    <script src="//code.jquery.com/jquery-1.10.1.min.js"></script>
  </body>
</html>